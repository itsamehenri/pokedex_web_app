<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-4Q6Gf2aSP4eDXB8Miphtr37CMZZQ5oXLH2yaXMJ2w8e2ZtHTl7GptT4jmndRuHDT" crossorigin="anonymous">
    <style>
        .pokemon-sprite {
            width: 60px;
            height: 60px;
        }
        .pokemon-search {
            margin-top: 30px;
        }
    </style>
    <title>HOME PAGE</title>
</head>
<body>
    <!-- START NAV BAR -->
    <div class="container p-3">
        <form action="#">
            <div class="row">
                <div class="col-sm-2">
                    <a href="#"><img src="static/logo/pokemon-logo-1.png" alt="" class="pokemon-logo img-fluid"></a>
                </div>
                <div class="col-sm-2">
                    <label for="name" class="form-label">Pokemon Name</label>
                    <input type="text" id="pokemon-name" class="form-control" name="name" placeholder="Name">
                </div>
                <div class="col-sm-2">
                    <label for="type1" class="form-label">Primary Type</label>
                    <select id="pokemon-selected-type-1" class="form-control form-select" name="type1">
                        <option value="0" selected="selected">All</option>
                        {% for type in types %}
                        <option value="{{type.type_id}}">{{type.type_name|title}}</option>
                        {% endfor %}
                    </select>
                </div>
                <div class="col-sm-2">
                    <label for="type2" class="form-label">Secondary Type</label>
                    <select id="pokemon-selected-type-2" class="form-control form-select" name="type2">
                        <option value="0" selected>All</option>
                        {% for type in types %}
                        <option value="{{type.type_id}}">{{type.type_name|title}}</option>
                        {% endfor %}
                    </select>
                </div>
                <div class="col-sm-2">
                    <label for="region" class="form-label">Region</label>
                    <select id="pokemon-selected-region" class="form-control form-select" name="region">
                        <option value="0" selected>All</option>
                        {% for region in regions %}
                        <option value="{{region.generation_id}}">{{region.generation_name|title}}</option>
                        {% endfor %}
                    </select>
                </div>
                <div class="col-sm">
                    <button class="btn btn-warning form-control pokemon-search" type="submit" name="search">Search</button>
                </div>
            </div>
        </form>
        <table class="table table-hover mt-4">
            <thead class="table-dark">
                <tr>
                    <th>NID</th>
                    <th>Artwork</th>
                    <th>Pokemon Name</th>
                    <th>Primary Type</th>
                    <th>Secondary Type</th>
                    <th>Region</th>
                </tr>
            </thead>    
            <tbody>
            {% for p in data %}
                <tr>
                    <td class="pt-4"># {{p[1]}}</td>
                    <td><img src="static/sprites/{{p[0]}}-{{p[1]}}-{{p[2]}}.png" alt="" class="pokemon-sprite img-fluid"></td>
                    <td class="pt-4">{{p.pokemon_name.replace("-", " ")|title}}</td>
                    <td class="pt-4">{{p.pokemon_type_1|title}}</td>
                    <td class="pt-4">
                        {% if p.pokemon_type_2 != None %}
                            {{p.pokemon_type_2|title}}
                        {% else %}
                            {{''}}
                        {% endif %}
                    </td>
                    <td class="pt-4">{{p.pokemon_generation|title}}</td>
                </tr>
            {%endfor%}
            </tbody>
        </table>
        {% if data|length == 0 %}
        <div class="alert alert-warning mt-4" role="alert">We haven't found any Pokemon</div>
        {% else %} 
        <nav>
            <ul class="pagination justify-content-center">
                {% if page > 1 %}
                <li class="page-item"><a class="page-link" href="{{url_for('home', page=page-1, name=name, type1=t1, type2=t2, region=region)}}">Previous</a></li>
                {% endif %}
                <li class="page-item" disabled><span class="page-link">Page {{page}} of {{total_pages}}</span></li>
                {% if page < total_pages %}
                <li class="page-item"><a class="page-link" href="{{url_for('home', page=page+1, name=name, type1=t1, type2=t2, region=region)}}">Next</a></li>
                {% endif %}
            </ul>
        </nav>
        {% endif %}
    </div>
    <!-- END NAV BAR -->
    <script>
        let input_name = document.getElementById("pokemon-name")
        let select_t1 = document.getElementById('pokemon-selected-type-1');
        let select_t2 = document.getElementById('pokemon-selected-type-2');
        let select_region = document.getElementById('pokemon-selected-region');
        input_name.value = '{{name}}';
        select_t1.value = '{{t1}}';
        select_t2.value = '{{t2}}';
        select_region.value = '{{region}}';
        console.log(select_t1.value);
        console.log(select_t2.value);
        console.log(select_region.value);
        console.log(input_name.value);

        if(select_t1.value === "" && select_t2.value === "" && select_region.value === ""){
            select_t1.value = "0";
            select_t2.value = "0";
            select_region.value = "0";
        }
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/js/bootstrap.bundle.min.js" integrity="sha384-j1CDi7MgGQ12Z7Qab0qlWQ/Qqz24Gc6BM0thvEMVjHnfYGF0rmFCozFSxQBxwHKO" crossorigin="anonymous"></script>
</body>
</html>